(()=>{(function(S){"use strict";let l={};S.TMUtils=l,typeof unsafeWindow<"u"&&(unsafeWindow.TMUtils=l),"__apiKeyCache"in l||(l.__apiKeyCache=null);function W(o){if(!o)return"";if(/^(Basic|Bearer)\s/i.test(o))return o.trim();try{return`Basic ${btoa(o.trim())}`}catch{return""}}async function q({wait:o=!1,timeoutMs:t=0,pollMs:e=200,useCache:s=!0,cacheMs:u=5*6e4}={}){let f=l.__apiKeyCache;if(s&&f&&Date.now()-f.ts<u)return f.value;let r=typeof unsafeWindow<"u"?unsafeWindow:S,i=()=>r?.PlexAuth&&typeof r.PlexAuth.getKey=="function"&&r.PlexAuth.getKey||r?.PlexAPI&&typeof r.PlexAPI.getKey=="function"&&r.PlexAPI.getKey||null,n=i();if(!n&&o&&t>0){let a=Date.now();for(;!n&&Date.now()-a<t;)await new Promise(d=>setTimeout(d,e)),n=i()}if(n)try{let a=n.call(r),d=a&&typeof a.then=="function"?await a:a,y=W(d);if(y){try{localStorage.setItem("PlexApiKey",y)}catch{}try{typeof GM_setValue=="function"&&GM_setValue("PlexApiKey",y)}catch{}return s&&(l.__apiKeyCache={value:y,ts:Date.now()}),y}}catch{}try{let a=typeof GM_getValue=="function"?GM_getValue("PlexApiKey",""):"";if(a){let d=W(a);return s&&(l.__apiKeyCache={value:d,ts:Date.now()}),d}}catch{}try{let a=localStorage.getItem("PlexApiKey")||"";if(a){let d=W(a);return s&&(l.__apiKeyCache={value:d,ts:Date.now()}),d}}catch{}return""}l.fetchData=async function(t,{method:e="GET",headers:s={},body:u,timeoutMs:f=15e3,useXHR:r=!1}={}){let i=W(await l.getApiKey().catch(()=>"")),n={Accept:"application/json",...u?{"Content-Type":"application/json;charset=UTF-8"}:{},...i?{Authorization:i}:{},...s},a=typeof u=="string"?u:u?JSON.stringify(u):void 0;if(r&&typeof GM_xmlhttpRequest=="function")return new Promise((g,m)=>{let _=setTimeout(()=>m(new Error("Network timeout")),f);GM_xmlhttpRequest({method:e,url:t,headers:n,data:a,timeout:f,onload:v=>{if(clearTimeout(_),!(v.status>=200&&v.status<300))return m(new Error(`${v.status} ${v.statusText||"Request failed"}`));try{g(JSON.parse(v.responseText||"{}"))}catch{g({})}},onerror:()=>{clearTimeout(_),m(new Error("Network error"))},ontimeout:()=>{clearTimeout(_),m(new Error("Network timeout"))}})});let d=new AbortController,y=setTimeout(()=>d.abort(),f);try{let g=await fetch(t,{method:e,headers:n,body:a,signal:d.signal,credentials:"include"});if(!g.ok)throw new Error(`${g.status} ${g.statusText}`);let m=await g.text();return m?JSON.parse(m):{}}finally{clearTimeout(y)}},l.ds=async function(t,e,s={}){let u=`${location.origin}/api/datasources/${t}/execute?format=2`,f=await l.fetchData(u,{method:"POST",body:e,...s}),r=Array.isArray(f?.rows)?f.rows:[];return{...f,rows:r}},l.dsRows=async function(t,e,s={}){let{rows:u}=await l.ds(t,e,s);return u},(function(){try{let t=typeof unsafeWindow<"u"?unsafeWindow.ko:S.ko;l.unwrap||(l.unwrap=function(s){try{return t&&typeof t.unwrap=="function"?t.unwrap(s):typeof s=="function"?s():s}catch{return s}}),l.unwrapDeep||(l.unwrapDeep=function(s){let u=new WeakMap,f=n=>!!n&&typeof n=="function"&&(t&&t.isObservable&&t.isObservable(n)||t&&t.isComputed&&t.isComputed(n)||typeof n.subscribe=="function"||n._isObs===!0),r=n=>t&&typeof t.unwrap=="function"?t.unwrap(n):typeof n=="function"&&f(n)?n():n,i=n=>{if(n==null)return n;let a=typeof n;if(a==="string"||a==="number"||a==="boolean")return n;if(Array.isArray(n))return n.map(i);if(a==="function")return r(n);if(a==="object"){if(u.has(n))return u.get(n);let d=Array.isArray(n)?[]:{};u.set(n,d);for(let y in n)Object.prototype.hasOwnProperty.call(n,y)&&(d[y]=i(n[y]));return d}return n};return i(s)}),l.jsonPlain||(l.jsonPlain=function(s,u=0){try{return JSON.stringify(l.unwrapDeep(s),null,u)}catch{return JSON.stringify(s,null,u)}})}catch{}})(),(function(){let t=typeof unsafeWindow<"u"?unsafeWindow:S,e=t.ko;function s(u,f){let r=t?.plex?.data?.getObservableOrValue;return typeof r=="function"?r(u,f):void 0}l.getObsValue=function(f,r,{first:i=!0,trim:n=!1,deep:a=!0,allowPlex:d=!0,coalesceFalsy:y=!1}={}){if(!f||!r)return;let g=typeof unsafeWindow<"u"?unsafeWindow:S,m=g.ko,_=c=>{try{return l.unwrap?l.unwrap(c):m?.unwrap?m.unwrap(c):typeof c=="function"?c():c}catch{return c}},v=c=>{try{return l.unwrapDeep?l.unwrapDeep(c):m?.unwrap?m.unwrap(c):typeof c=="function"?c():c}catch{return c}},E=c=>!!c&&typeof c=="function"&&(m?.isObservable?.(c)||"peek"in c||"subscribe"in c||"notifySubscribers"in c),b=f;if(f&&f.nodeType===1)try{let c=m?.contextFor?.(f);b=c?.$root?.data??c?.$root??c?.$data??f}catch{}let A=Array.isArray(r)?r:[r],D=c=>{try{let p=g?.plex?.data?.getObservableOrValue;if(d&&typeof p=="function"){let w=p(b,c);return typeof w=="function"?w():w}}catch{}},x=c=>{try{let p=String(c).split("."),w=b;for(let P of p)if(w=w?.[P],w===void 0)break;return typeof w=="function"&&E(w)?w():w}catch{return}};for(let c of A){let p=D(c);if(p===void 0&&(p=x(c)),p=a?v(p):_(p),i&&Array.isArray(p)&&(p=p.length?p[0]:void 0),n&&(typeof p=="string"||typeof p=="number")&&(p=String(p).trim()),p!=null&&(y||p!==""))return p}},l.setObsValue=function(f,r,i){if(!f||!r)return;let n=typeof unsafeWindow<"u"?unsafeWindow:S,a=n.ko,d=(b,A)=>b?Array.isArray(A)?A:[A]:A,y=n?.plex?.data?.getObservableOrValue;if(typeof y=="function"){let b=y(f,r);if(typeof b=="function"){if(!!(b&&typeof b.push=="function"&&typeof b.removeAll=="function")){b.removeAll();let c=d(!0,i);c.length&&b.push(...c);return}let D;try{D=b()}catch{D=void 0}let x=Array.isArray(D);b(d(x,i));return}}let g=r.split("."),m=g.pop(),_=g.reduce((b,A)=>b==null?b:b[A],f);if(!_)return;let v=_[m];if(a&&typeof a.isObservable=="function"&&a.isObservable(v)&&typeof v.push=="function"&&typeof v.removeAll=="function"){v.removeAll();let b=d(!0,i);b.length&&v.push(...b);return}if(typeof v=="function"){let b;try{b=v()}catch{b=void 0}let A=Array.isArray(b);v(d(A,i));return}let E=Array.isArray(v);_[m]=d(E,i)},l.coerceId=function(f){let r=l.unwrapDeep?l.unwrapDeep(f):f,i=Array.isArray(r)?r.length?r[0]:void 0:r;return String(i??"").trim()}})();function N(){document.getElementById("tm-msg")?.remove()}function R(o,{type:t="info",autoClear:e=4e3}={}){N();let s={info:{bg:"#d9edf7",fg:"#31708f"},success:{bg:"#dff0d8",fg:"#3c763d"},warning:{bg:"#fcf8e3",fg:"#8a6d3b"},error:{bg:"#f2dede",fg:"#a94442"}}[t]||{bg:"#fff",fg:"#000"},u=document.createElement("div");u.id="tm-msg",Object.assign(u.style,{position:"fixed",top:"10px",right:"10px",padding:"8px 12px",backgroundColor:s.bg,color:s.fg,border:`1px solid ${s.fg}`,borderRadius:"4px",boxShadow:"0 2px 6px rgba(0,0,0,0.2)",zIndex:1e4,fontSize:"0.9em",maxWidth:"80%",whiteSpace:"pre-line"}),u.textContent=o,document.body.appendChild(u),e&&setTimeout(N,e)}function G(o,t="info",e){R(o,{type:t,autoClear:e??4e3})}function H(o,t){let e=new MutationObserver(()=>{let u=document.querySelector(o);u&&(e.disconnect(),t(u))});e.observe(document.body,{childList:!0,subtree:!0});let s=document.querySelector(o);s&&(e.disconnect(),t(s))}function j(o,{pollMs:t=250,timeoutMs:e=3e4,requireKo:s=!0,logger:u=null,log:f=!1}={}){let r=Date.now(),i=()=>typeof S<"u"&&S.ko||typeof unsafeWindow<"u"&&unsafeWindow.ko||null,n=(a,...d)=>{u&&typeof u[a]=="function"?u[a](...d):f&&(console[a]||console.log)(...d)};return new Promise((a,d)=>{function y(){let m=document.querySelector(o);if(!m)return g();if(!s)return f&&console.debug("\u{1F50D} waitForModelAsync (no KO):",{sel:o,el:m}),a({element:m,controller:null,viewModel:null});let _=i();if(!_||typeof _.contextFor!="function")return g();let v=null,E=null;try{let b=_.contextFor(m);v=b&&b.$data||null,E=v&&v.model||null,!E&&b&&(E=b.$root?.data||b.$root||null)}catch{}if((u||f)&&(console.groupCollapsed("\u{1F50D} waitForModelAsync"),n("debug","selector \u2192",o),n("debug","controller \u2192",v),n("debug","vm \u2192",E),console.groupEnd()),E)return a({element:m,controller:v,viewModel:E});g()}function g(){if(Date.now()-r>=e){let m=`Timed out waiting for "${o}" after ${e}ms`;return n("warn","\u231B waitForModelAsync",m),d(new Error(m))}setTimeout(y,t)}y()})}function J(o,t){let e=Array.from(o.options).find(s=>s.textContent.trim()===t);e&&(o.value=e.value,o.dispatchEvent(new Event("change",{bubbles:!0})))}function Q(o,t){let e=Array.from(o.options).find(s=>s.value==t);e&&(o.value=e.value,o.dispatchEvent(new Event("change",{bubbles:!0})))}function z(o){try{return o.test(location.pathname)}catch{return!1}}function I(o,t){let e=null;return()=>{e&&clearTimeout(e),e=setTimeout(()=>{e=null,o()},t)}}function X(o){if(history.__tmWrapped){o(location.pathname);return}let t=()=>{try{o(location.pathname)}catch(u){console.warn("onRouteChange handler error",u)}},e=history.pushState;history.pushState=function(){e.apply(this,arguments),S.dispatchEvent(new Event("locationchange"))};let s=history.replaceState;history.replaceState=function(){s.apply(this,arguments),S.dispatchEvent(new Event("locationchange"))},S.addEventListener("popstate",t),S.addEventListener("locationchange",t),history.__tmWrapped=!0,t()}function Y(o,t=location.pathname){return o?o instanceof RegExp?o.test(t):Array.isArray(o)?o.some(e=>e.test(t)):!1:!1}let Z=!1;function tt(o){Z=!!o}function et(o){let t=o||"TM",e=(s,u,...f)=>(console[s]||console.log).call(console,`${t} ${u}`,...f);return{log:(...s)=>e("log","\u25B6\uFE0F",...s),info:(...s)=>e("info","\u2139\uFE0F",...s),warn:(...s)=>e("warn","\u26A0\uFE0F",...s),error:(...s)=>e("error","\u2716\uFE0F",...s),ok:(...s)=>e("log","\u2705",...s)}}function nt(...o){console.log("TM \u25B6\uFE0F",...o)}function ot(...o){console.warn("TM \u26A0\uFE0F",...o)}function rt(...o){console.error("TM \u2716\uFE0F",...o)}function st(...o){console.log("TM \u2705",...o)}function at(){try{let o=typeof GM_info<"u"&&GM_info?.script?.name||"";return o&&o.split(/[ \t–—\-→➜>]/)[0].trim()||"TM"}catch{return"TM"}}function V(o){let t=o||at();return l.makeLogger?l.makeLogger(t):{log:(...e)=>console.log(`${t} \u25B6\uFE0F`,...e),info:(...e)=>console.info(`${t} \u2139\uFE0F`,...e),warn:(...e)=>console.warn(`${t} \u26A0\uFE0F`,...e),error:(...e)=>console.error(`${t} \u2716\uFE0F`,...e),ok:(...e)=>console.log(`${t} \u2705`,...e)}}function ct(o){let t=V(o);return S.L=t,typeof unsafeWindow<"u"&&(unsafeWindow.L=t),t}l.watchByLabel=function({labelText:t,onChange:e,initial:s=!0,fireOn:u="change",settleMs:f=250,koPrefer:r="root",bagKeys:i=["value","displayValue","boundDisplayValue","textInput"],widgetSelector:n='.k-combobox,.k-dropdown,.k-dropdownlist,.k-autocomplete,[role="combobox"]',timeoutMs:a=3e4,logger:d=null}={}){let y=typeof unsafeWindow<"u"?unsafeWindow.ko:S.ko,g=c=>y?.isObservable?.(c)||typeof c=="function"&&typeof c.subscribe=="function",m=c=>y?.unwrap?y.unwrap(c):typeof c=="function"?c():c,_=(...c)=>d?.log?.(...c),v=c=>String(c||"").toLowerCase().replace(/\u00a0/g," ").replace(/[*:]/g,"").replace(/\s+/g," ").trim(),E=t instanceof RegExp?t:v(t),b=()=>{let c=[...document.querySelectorAll("label[for]")];for(let p of c){let w=v(p.textContent||p.getAttribute("data-original-text")||"");if(t instanceof RegExp?t.test(w):w===E||w.startsWith(E))return p}return null};function A(){let c=b();if(!c)return null;let p=c.getAttribute("for"),w=p&&document.getElementById(p);if(!w)return null;let P=null;if(y?.contextFor)try{let h=y.contextFor(w),M=(r==="data"?h?.$data?.elements?.[p]:h?.$root?.elements?.[p])||(r==="data"?h?.$root?.elements?.[p]:h?.$data?.elements?.[p]);if(M&&(P=i.map(C=>M[C]).find(Boolean)??null),!P){let C=w.getAttribute("data-bind")||"",F=/(?:value|textInput)\s*:\s*([^,}]+)/.exec(C);if(F){let $=F[1].trim(),B=it=>{try{return Function("with(this){return ("+$+")}").call(it)}catch{return}};P=B(h?.$data),P===void 0&&(P=B(h?.$root))}}}catch{}let K=w.closest(n),k=K?.querySelector("input")||w,U=()=>{let h=P!==null?m(P):(w.value??"").toString();return(Array.isArray(h)?h[0]:h)?.toString().trim()||""},O=I(()=>{let h=U();h&&typeof e=="function"&&e(h)},f),T=[];if(s&&u!=="blur"&&O(),g(P)){let h=P.subscribe(()=>O());T.push(()=>h.dispose?.()),_?.("watchByLabel: KO subscription attached for",t)}if(u==="blur"){let h=()=>O(),M=()=>O(),C=$=>{($.key==="Tab"||$.key==="Enter")&&setTimeout(O,0)};k.addEventListener("focusout",h,!0),k.addEventListener("change",M),k.addEventListener("keydown",C),K&&K!==k&&(K.addEventListener("focusout",h,!0),K.addEventListener("change",M,!0));let F=new MutationObserver(()=>O());F.observe(k,{childList:!0,characterData:!0,subtree:!0}),T.push(()=>{k.removeEventListener("focusout",h,!0),k.removeEventListener("change",M),k.removeEventListener("keydown",C),K&&K!==k&&(K.removeEventListener("focusout",h,!0),K.removeEventListener("change",M,!0)),F.disconnect()})}else{let h=()=>O();k.addEventListener("change",h),T.push(()=>k.removeEventListener("change",h))}return _?.("watchByLabel: listeners attached for",t,k),()=>{T.forEach(h=>{try{h()}catch{}})}}let D=A();if(typeof D=="function")return D;let x=new MutationObserver(()=>{D=A(),typeof D=="function"&&x.disconnect()});return x.observe(document.body,{childList:!0,subtree:!0}),setTimeout(()=>x.disconnect(),a),()=>{try{typeof D=="function"&&D()}catch{}try{x.disconnect()}catch{}}},l.awaitValueByLabel=function({labelText:t,timeoutMs:e=3e4,logger:s=null}={}){return new Promise((u,f)=>{let r=null,i=!1,n=setTimeout(()=>{i||(i=!0,r?.(),f(new Error("Timeout")))},e);r=l.watchByLabel({labelText:t,initial:!0,logger:s,onChange:a=>{i||!a||(i=!0,clearTimeout(n),r?.(),u(a))}})})},l.watchBySelector=function({selector:t,onChange:e,initial:s=!0,fireOn:u="change",settleMs:f=250,koPrefer:r="root",bagKeys:i=["value","displayValue","boundDisplayValue","textInput"],widgetSelector:n='.k-combobox,.k-dropdown,.k-dropdownlist,.k-autocomplete,[role="combobox"]',timeoutMs:a=3e4,logger:d=null}={}){let y=typeof unsafeWindow<"u"?unsafeWindow.ko:S.ko,g=A=>y?.isObservable?.(A)||typeof A=="function"&&typeof A.subscribe=="function",m=A=>y?.unwrap?y.unwrap(A):typeof A=="function"?A():A,_=(...A)=>d?.log?.(...A);function v(){let A=document.querySelector(t);if(!A)return null;let D=null,x=null,c=null;try{D=y?.contextFor?y.contextFor(A):null;let L=A.id,O=L&&D?.$root?.elements?.[L],T=L&&D?.$data?.elements?.[L];if(x=(r==="data"?T:O)||(r==="data"?O:T)||null,x){let h=i.map(M=>x[M]).find(Boolean);g(h)&&(c=h)}if(!c&&y?.contextFor){let h=A.getAttribute("data-bind")||"",M=/(?:value|textInput)\s*:\s*([^,}]+)/.exec(h);if(M){let C=M[1].trim(),$=(B=>{try{return Function("with(this){return ("+C+")}").call(B)}catch{return}})(D?.[r==="data"?"$data":"$root"]);g($)&&(c=$)}}}catch{}let p=A.closest(n),w=p?.querySelector("input")||A,P=()=>{let L;if(c)L=m(c);else if(x){let T=i.map(h=>x[h]).find(Boolean);L=typeof T=="function"?T():T}return(L==null||L==="")&&(L=A.value??A.textContent??""),((Array.isArray(L)?L[0]:L)??"").toString().trim()},k=I(()=>{let L=P();L!==""&&typeof e=="function"&&e(L)},f),U=[];if(s&&u!=="blur"&&k(),c&&typeof c.subscribe=="function"){let L=c.subscribe(()=>k());U.push(()=>L.dispose?.()),_?.("watchBySelector: KO observable subscription attached for",t)}if(x){let L=[],O=(T,h)=>{if(!T||typeof T[h]!="function")return;let M=T[h];T[h]=function(...F){try{k()}catch{}return M.apply(this,F)},L.push(()=>{T[h]=M})};["onchange","onblur","onkeyup","onkeydown"].forEach(T=>O(x,T)),U.push(()=>L.forEach(T=>{try{T()}catch{}})),_?.("watchBySelector: bag event wrappers attached for",t)}if(u==="blur"){let L=()=>k(),O=()=>k(),T=M=>{(M.key==="Tab"||M.key==="Enter")&&setTimeout(k,0)};w.addEventListener("focusout",L,!0),w.addEventListener("change",O),w.addEventListener("keydown",T),p&&p!==w&&(p.addEventListener("focusout",L,!0),p.addEventListener("change",O,!0));let h=new MutationObserver(()=>k());h.observe(w,{childList:!0,characterData:!0,subtree:!0}),U.push(()=>{w.removeEventListener("focusout",L,!0),w.removeEventListener("change",O),w.removeEventListener("keydown",T),p&&p!==w&&(p.removeEventListener("focusout",L,!0),p.removeEventListener("change",O,!0)),h.disconnect()})}else{let L=()=>k();w.addEventListener("change",L),U.push(()=>w.removeEventListener("change",L))}return _?.("watchBySelector: listeners attached for",t,w),()=>{U.forEach(L=>{try{L()}catch{}})}}let E=v();if(typeof E=="function")return E;let b=new MutationObserver(()=>{E=v(),typeof E=="function"&&b.disconnect()});return b.observe(document.body,{childList:!0,subtree:!0}),setTimeout(()=>b.disconnect(),a),()=>{try{typeof E=="function"&&E()}catch{}try{b.disconnect()}catch{}}},(function(){if(S.__tmUrlObsInstalled)return;S.__tmUrlObsInstalled=!0;let t="tmutils:urlchange",e=()=>S.dispatchEvent(new CustomEvent(t)),s=history.pushState;history.pushState=function(){let f=s.apply(this,arguments);return e(),f};let u=history.replaceState;history.replaceState=function(){let f=u.apply(this,arguments);return e(),f},S.addEventListener("popstate",e),l.onUrlChange=function(r){let i=()=>r(location);return S.addEventListener(t,i),()=>S.removeEventListener(t,i)},l._dispatchUrlChange=e})(),l.observeInsertMany=function(t,e,{root:s=document.body,subtree:u=!0}={}){let f=new WeakSet;function r(n){if(n&&n.nodeType===1){if(typeof n.matches=="function"&&n.matches(t)&&!f.has(n)){f.add(n);try{e(n)}catch(a){console.error("observeInsertMany callback error:",a)}}typeof n.querySelectorAll=="function"&&n.querySelectorAll(t).forEach(a=>{if(!f.has(a)){f.add(a);try{e(a)}catch(d){console.error("observeInsertMany callback error:",d)}}})}}let i=new MutationObserver(n=>{for(let a of n)a.addedNodes&&a.addedNodes.length&&a.addedNodes.forEach(r)});return i.observe(s,{childList:!0,subtree:u}),r(s),()=>i.disconnect()},l.sleep=o=>new Promise(t=>setTimeout(t,o)),(function(){let t=typeof unsafeWindow<"u"?unsafeWindow:S,e=S.TMUtils;e.net=e.net||{},e.net.ensureWatcher=function(){if(t.__ltNetPatched)return;t.__ltNetPatched=!0;let i=t.fetch&&t.fetch.bind(t);i&&(t.fetch=function(a,d){try{let y=a instanceof Request?a:new Request(a,d||{}),g=String(y.url||""),m=(y.method||d&&d.method||"GET").toUpperCase();s(g,m)&&y.clone().arrayBuffer().then(_=>{let v=y.headers.get("content-type")||"",E=u(_,v);e.net._handleAddUpdate(g,E)}).catch(()=>{})}catch{}return i(a,d)});let n=t.XMLHttpRequest;if(n&&n.prototype){let a=n.prototype.open,d=n.prototype.send,y=n.prototype.setRequestHeader;n.prototype.open=function(g,m){return this.__ltMethod=String(g||"GET").toUpperCase(),this.__ltUrl=String(m||""),this.__ltHeaders={},a.apply(this,arguments)},n.prototype.setRequestHeader=function(g,m){try{this.__ltHeaders[g.toLowerCase()]=m}catch{}return y.apply(this,arguments)},n.prototype.send=function(g){try{let m=this.__ltUrl||"",_=this.__ltMethod||"GET";if(s(m,_)){let v=this.__ltHeaders["content-type"]||"",E={};typeof g=="string"?E=f(g,v):(g instanceof URLSearchParams||t.FormData&&g instanceof FormData)&&(E=Object.fromEntries(g.entries())),e.net._handleAddUpdate(m,E)}}catch{}return d.apply(this,arguments)}}},e.net.onAddUpdate=function(i){if(typeof i!="function")return()=>{};let n=a=>i(a.detail||{});return t.addEventListener("LT:QuotePartAddUpdateForm",n),()=>t.removeEventListener("LT:QuotePartAddUpdateForm",n)},e.net.getLastAddUpdate=function(){if(e.state?.lastAddUpdateForm)return e.state.lastAddUpdateForm;try{let r=sessionStorage.getItem("LT_LAST_ADDUPDATEFORM");return r?JSON.parse(r):null}catch{return null}};function s(r,i){return i==="POST"&&/\/SalesAndCRM\/QuotePart\/AddUpdateForm/i.test(r)&&/(?:\?|&)sourceActionKey=10032(?:&|$)/i.test(r)}function u(r,i){try{let n=new TextDecoder().decode(r||new Uint8Array);return f(n,i)}catch{return{}}}function f(r,i){if(!r)return{};let n=(i||"").toLowerCase();if(n.includes("application/json")||/^[\s{\[]/.test(r))try{return JSON.parse(r)}catch{}if(n.includes("application/x-www-form-urlencoded")||r.includes("="))try{return Object.fromEntries(new URLSearchParams(r).entries())}catch{}return{}}e.net._handleAddUpdate=function(r,i){let n=Number(i?.QuoteKey)||Number((/[?&]QuoteKey=(\d+)/i.exec(r)||[])[1])||void 0,a=!!(i?.PartNo||i?.PartKey||i?.PartName)||Array.isArray(i?.__revisionTrackingData)&&i.__revisionTrackingData.some(y=>Array.isArray(y.revisionTrackingEntries)&&y.revisionTrackingEntries.some(g=>/Part No/i.test(g?.Field||""))),d={url:r,quoteKey:n,hasPartNo:a,partNo:i?.PartNo??null,customerPartNo:i?.CustomerPartNo??null,partKey:i?.PartKey??null,at:Date.now()};e.state=e.state||{},e.state.lastAddUpdateForm=d;try{sessionStorage.setItem("LT_LAST_ADDUPDATEFORM",JSON.stringify(d))}catch{}try{t.dispatchEvent(new CustomEvent("LT:QuotePartAddUpdateForm",{detail:d}))}catch{}}})(),Object.assign(l,{getApiKey:q,fetchData:l.fetchData,waitForModelAsync:j,watchByLabel:l.watchByLabel,awaitValueByLabel:l.awaitValueByLabel,watchBySelector:l.watchBySelector,observeInsertMany:l.observeInsertMany,showMessage:R,hideMessage:N,observeInsert:H,selectOptionByText:J,selectOptionByValue:Q,toast:G,log:nt,warn:ot,error:rt,ok:st,ensureRoute:z,onRouteChange:X,matchRoute:Y,setDebug:tt,makeLogger:et,getLogger:V,attachLoggerGlobal:ct,ds:l.ds,dsRows:l.dsRows,net:l.net})})(window);})();
