(()=>{(function(){let t="PlexApiKey";function a(e){return e?/^(Basic|Bearer)\s/i.test(e)?e.trim():`Basic ${btoa(e.trim())}`:""}async function c(e){await GM_setValue(t,e);try{localStorage.setItem(t,e)}catch{}}function s(){let e=GM_getValue(t,"");if(e)return a(e);try{let n=localStorage.getItem(t)||"";if(n)return GM_setValue(t,n),a(n)}catch{}return""}async function i(){let e=prompt('Enter Plex credentials as "username:password", or paste a full "Basic <base64>" token:');if(!e)return;let n=a(e);await c(n),alert("\u{1F510} Plex API Key saved")}async function o(){await GM_setValue(t,"");try{localStorage.removeItem(t)}catch{}alert("\u{1F510} Plex API Key cleared")}let r={getKey:s,setKey:i,clearKey:o};window.PlexAPI=r,window.PlexAuth=r;try{unsafeWindow.PlexAuth=r}catch{}typeof GM_registerMenuCommand=="function"&&(GM_registerMenuCommand("\u2699\uFE0F Set Plex API Key",i),GM_registerMenuCommand("\u{1F9F9} Clear Plex API Key",o))})();})();
